#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Run linter
echo "ğŸ“‹ Running linter..."
npm run lint || {
  echo "âŒ Linting failed. Please fix the issues above."
  exit 1
}

# Build the project
echo "ğŸ”¨ Building project..."
npm run build || {
  echo "âŒ Build failed. Please fix the issues above."
  exit 1
}

# Run basic tests
echo "ğŸ§ª Running basic tests..."
npm test -- tests/basic.test.ts || {
  echo "âŒ Basic tests failed. Please fix the issues above."
  exit 1
}

# Run alias tests (most important for our recent changes)
echo "ğŸ”— Running alias tests..."
npm test -- tests/aliases.test.ts || {
  echo "âŒ Alias tests failed. Please fix the issues above."
  exit 1
}

# Quick CLI smoke test
echo "ğŸš€ Running CLI smoke test..."
node dist/index.js --version > /dev/null || {
  echo "âŒ CLI smoke test failed."
  exit 1
}

echo "âœ… All pre-commit checks passed!"